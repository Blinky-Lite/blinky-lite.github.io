<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/docs/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(2)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(2) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(2) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list { display: block; } </style> <script src="/docs/assets/js/vendor/lunr.min.js"></script> <script src="/docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/docs/assets/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Architecture | Blinky-Lite</title> <meta name="generator" content="Jekyll v4.3.0" /> <meta property="og:title" content="Architecture" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Blinky-Lite" /> <meta property="og:description" content="Blinky-Lite" /> <link rel="canonical" href="/docs/pages/Overview/architecture.html" /> <meta property="og:url" content="/docs/pages/Overview/architecture.html" /> <meta property="og:site_name" content="Blinky-Lite" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Architecture" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Blinky-Lite","headline":"Architecture","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/docs/assets/images/project-logo.png"}},"url":"/docs/pages/Overview/architecture.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/docs/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Blinky-Lite"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Overview category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/" class="nav-list-link">Overview</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/pages/Overview/features.html" class="nav-list-link">Features</a></li><li class="nav-list-item"><a href="/docs/pages/Overview/architecture.html" class="nav-list-link">Architecture</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in App Overview category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/pages/Overview/appOverview.html" class="nav-list-link">App Overview</a><ul class="nav-list"><li class="nav-list-item"> <a href="/docs/pages/Overview/cubeExplorerAppPreview.html" class="nav-list-link">Cube Explorer App</a> </li><li class="nav-list-item"> <a href="/docs/pages/Overview/appBuilderPreview.html" class="nav-list-link">Application Builder</a> </li><li class="nav-list-item"> <a href="/docs/pages/Overview/myAppsPreview.html" class="nav-list-link">MyApps</a> </li><li class="nav-list-item"> <a href="/docs/pages/Overview/alarmScannerAppPreview.html" class="nav-list-link">Alarm Scanner App</a> </li><li class="nav-list-item"> <a href="/docs/pages/Overview/settingsLogAppPreview.html" class="nav-list-link">Settings Log App</a> </li><li class="nav-list-item"> <a href="/docs/pages/Overview/accessLogAppPreview.html" class="nav-list-link">Access Log App</a> </li><li class="nav-list-item"> <a href="/docs/pages/Overview/styleSheets.html" class="nav-list-link">App Style Sheets</a> </li><li class="nav-list-item"> <a href="/docs/pages/Overview/appAuthentication.html" class="nav-list-link">App Authentication</a> </li><li class="nav-list-item"> <a href="/docs/pages/Overview/roleBasedAccess.html" class="nav-list-link">Role Based Access</a> </li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Installation category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/pages/Installation/installOverview.html" class="nav-list-link">Installation</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/pages/Installation/appServerInstall.html" class="nav-list-link">Application Server</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Blinky-Lite" aria-label="Search Blinky-Lite" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://www.blinky-lite.org/" class="site-button" > blinky-lite.org </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/Blinky-Lite" class="site-button" > GitHub </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/">Overview</a></li> <li class="breadcrumb-nav-list-item"><span>Architecture</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="blinky-lite-architecture"> <a href="#blinky-lite-architecture" class="anchor-heading" aria-labelledby="blinky-lite-architecture"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Blinky-Lite Architecture </h1> <details open=""> <summary class="text-delta"> Table of contents </summary> <ul id="markdown-toc"> <li><a href="#blinky-lite-architecture" id="markdown-toc-blinky-lite-architecture">Blinky-Lite Architecture</a> <ul> <li><a href="#the-application-box" id="markdown-toc-the-application-box">The Application Box</a> <ul> <li><a href="#the-mqtt-broker" id="markdown-toc-the-mqtt-broker">The MQTT Broker</a></li> <li><a href="#the-application-server" id="markdown-toc-the-application-server">The Application Server</a></li> <li><a href="#the-database-server" id="markdown-toc-the-database-server">The Database Server</a></li> </ul> </li> <li><a href="#message-trays" id="markdown-toc-message-trays">Message Trays</a></li> <li><a href="#cube-controllers" id="markdown-toc-cube-controllers">Cube Controllers</a></li> </ul> </li> </ul> </details> <p>The <strong>Blinky-Lite</strong> Architecture consists of three major components:</p> <ul> <li>Application Box</li> <li>Message Trays</li> <li>Controller Cubes</li> </ul> <p align="center"><img src="/docs/assets/images/architecture.jpg" /></p> <p align="center">Fig. 1 Blinky-Lite Architecture</p> <h2 id="the-application-box"> <a href="#the-application-box" class="anchor-heading" aria-labelledby="the-application-box"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Application Box </h2> <p>The Application Box is comprised of three services, the MQTT Broker, the Application Server, and the Database Server. Each of these three services can be hosted on the same computer inside a firewall or on the cloud, or each service can be hosted on its own computer inside a firewall or on the cloud. For reliability and ease of installation, the preferred method is to have each service hosted own its own machine in the cloud.</p> <ul> <li> <h3 id="the-mqtt-broker"> <a href="#the-mqtt-broker" class="anchor-heading" aria-labelledby="the-mqtt-broker"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The MQTT Broker </h3> <p>The MQTT broker provides:.</p> <ul> <li><ins>Communication exchange</ins> <br /> The communication protocol for <strong>Blinky-Lite</strong> is <a href="https://mqtt.org/">MQTT</a>. MQTT uses a publish-subscribe paradigm. The MQTT Broker relays messages between message trays and the Application Server. For prompt communications, the MQTT broker can also relay messages directly between message trays without having to go through the Application Server</li> <li><ins>Data Pooling</ins><br /> Because of the publish-subscribe paradigm, The MQTT broker effectively protects the message trays from being overloaded from too many communication requests from the Application Server.</li> <li><ins>Security</ins><br /> The MQTT broker acts an additional layer of security because both the message trays and Application Server must authenticate to the MQTT broker to pass messages. Since the message tray must initiate the connection to the MQTT Broker, this eliminates the need for external SSH tunnels into your private network for remote access. Finally, the MQTT Broker can be easily configured to only accept specific and unique topics to and from each message tray adding another layer of security.</li> </ul> </li> <li> <h3 id="the-application-server"> <a href="#the-application-server" class="anchor-heading" aria-labelledby="the-application-server"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Application Server </h3> <p>The Application Server tasks are:</p> <ul> <li><ins>Alarm Scanning</ins><br /> The Application Server collects messages from the message trays via the MQTT Broker scans for alarms and routes these alarms to user alarm applications and the SMS messenger</li> <li><ins>Data Archival</ins><br /> The Application Server routes the messages from the message trays to the database server for status update and archival.</li> <li><ins>User application server</ins> <br /> The Application Server also hosts the user applications. The Application Server checks user requests via role-based access routing and and routes the requests to the appropriate message trays and database server. The application server is written using the <a href="https://nodered.org/">Node-RED</a> programming environment.<br /> Node-RED makes it easy: <ul> <li>to read, edit, and document the code</li> <li>for the user to change the code</li> <li>to version control the code</li> <li>to port the code to other machines</li> </ul> <p align="center"><img src="/docs/assets/images/nodeRedEnv.png" /></p> <p align="center">Fig. 2 Node-RED Programming Environment</p> </li> </ul> </li> <li> <h3 id="the-database-server"> <a href="#the-database-server" class="anchor-heading" aria-labelledby="the-database-server"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Database Server </h3> <p>Instead of using name-value pairs for describing the data as with most other control system platforms, <strong>Blinky-Lite</strong> uses a class structure to describe systems in the message trays. This structure makes communicating between subsystems and data archival much more streamlined and easy to read and modify. The data in the class structure is stored in <a href="https://www.json.org/json-en.html">JSON</a> objects which is a common lightweight data-interchange format ideal for communicating with mobile browser-based web applications. Most of the data in the control system is time-sequenced so a non-SQL type of database such as <a href="https://www.mongodb.com/">MongoDB</a> or <a href="https://rethinkdb.com/">RethinkDB</a> is much easier to configure and use. Currently, <strong>Blinky-Lite</strong> is configured to interface smoothly with a MongoDB database.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup></p> <p>The database is divided into collections of JSON object documents to not only handle data archiving but other services as well such as access logs and app configurations. The list of collections in a <strong>Blinky-Lite</strong> project is:</p> <ul> <li><span style="color:#ff6100"><strong><em>trays</em></strong></span> - tray configuration</li> <li><span style="color:#ff6100"><strong><em>archiver</em></strong></span> - tray data archiving</li> <li><span style="color:#ff6100"><strong><em>users</em></strong></span> - list of users, their credentials, and their roles</li> <li><span style="color:#ff6100"><strong><em>appConfig</em></strong></span> - configurations for the standard applications</li> <li><span style="color:#ff6100"><strong><em>appStyleSheets</em></strong></span> - custom CSS sheets for the standard applications</li> <li><span style="color:#ff6100"><strong><em>accessLog</em></strong></span> - record of all visits to the project</li> <li><span style="color:#ff6100"><strong><em>settingsLog</em></strong></span> - record of all tray settings made in the project</li> <li><span style="color:#ff6100"><strong><em>restAccessLog</em></strong></span> - record of all RESTful interface visits to the project</li> </ul> </li> </ul> <h2 id="message-trays"> <a href="#message-trays" class="anchor-heading" aria-labelledby="message-trays"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Message Trays </h2> <p>The concept of message trays is what makes <strong>Blinky-Lite</strong> truly versatile. The message trays communicate to a device using whatever protocol and hardware is supported by the device, such as Modbus, serial (UART, SPI, I2C, etc.), RS232, MQTT, etc. The message tray packages the device information into a <strong>Blinky-Lite</strong> Tray JSON object in a standard format that is discussed in [Need REF!].</p> <p>The tray message is then published to the Application Box MQTT broker. Since the Application Server subscribes to all the message tray topics in a <strong>Blinky-Lite</strong> project, the Application Server will receive this message. In this way, the applications on the Application Server can be standardized and reused from project to project. Also, any other tray that subscribes to the message tray’s unique topic can also receive the tray’s JSON object.</p> <p>The message tray can also subscribe to other message tray topics or messages sent from the Application Server. These messages can the be used to alter the state of the tray or devices the tray is connected to. As shown in Figure 1, more than one device can be connected to a single tray. Thus, the tray can function as a micro-control system in a truly Edge computing manner.</p> <p>Each message tray runs as a separate Node-RED flow. Usually, there is only a single tray flow running on a single Node-RED process running on a microcomputer such as a <a href="https://www.raspberrypi.org/">Raspberry Pi</a>. However, it is also possible to run multiple tray flows on a single Node-RED instance running on a computer other than a Raspberry Pi, such as computer in the cloud. Local and cloud trays are discussed in [Need Ref!]</p> <h2 id="cube-controllers"> <a href="#cube-controllers" class="anchor-heading" aria-labelledby="cube-controllers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cube Controllers </h2> <p>Cube controllers are not necessarily required in a <strong>Blinky-Lite</strong> project. For example, if the device is a Modbus device, then the tray can be directly connected to the device. An example ModBus tray can be found in [Need Ref!]. If the device is, for example, a stepper motor, then some hardware is required to interface the motor to translate tray commands. This is usually done through a micro-controller such as an <a href="https://www.arduino.cc/">Arduino</a>, <a href="https://www.pjrc.com/teensy/">Teensy</a>, or <a href="https://www.raspberrypi.com/products/raspberry-pi-pico/">Raspberry Pi Pico</a>. We have developed a number of serial and MQTT interfaces to micro-controllers that can be found at [Needs Ref!].</p><hr /> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:1" role="doc-endnote"> <p>MongoDB is not open-source software so the user must provide their own instance of a MongoDB database server. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> </ol> </div> </main> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Distributed by an <a href="https://raw.githubusercontent.com/Blinky-Lite/blinky-lite-box/master/LICENSE">MIT license.</a></p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
