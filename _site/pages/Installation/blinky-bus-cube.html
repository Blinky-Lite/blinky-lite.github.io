<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(3)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Blinky Bus Cube | Blinky-Lite</title> <meta name="generator" content="Jekyll v4.3.0" /> <meta property="og:title" content="Blinky Bus Cube" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Blinky-Lite" /> <meta property="og:description" content="Blinky-Lite" /> <link rel="canonical" href="/pages/Installation/blinky-bus-cube.html" /> <meta property="og:url" content="/pages/Installation/blinky-bus-cube.html" /> <meta property="og:site_name" content="Blinky-Lite" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Blinky Bus Cube" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Blinky-Lite","headline":"Blinky Bus Cube","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/project-logo.png"}},"url":"/pages/Installation/blinky-bus-cube.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Blinky-Lite"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Overview category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/" class="nav-list-link">Overview</a><ul class="nav-list"><li class="nav-list-item"><a href="/pages/Overview/features.html" class="nav-list-link">Features</a></li><li class="nav-list-item"><a href="/pages/Overview/architecture.html" class="nav-list-link">Architecture</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in App Overview category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/pages/Overview/appOverview.html" class="nav-list-link">App Overview</a><ul class="nav-list"><li class="nav-list-item"> <a href="/pages/Overview/cubeExplorerAppPreview.html" class="nav-list-link">Cube Explorer App</a> </li><li class="nav-list-item"> <a href="/pages/Overview/appBuilderPreview.html" class="nav-list-link">Application Builder</a> </li><li class="nav-list-item"> <a href="/pages/Overview/myAppsPreview.html" class="nav-list-link">MyApps</a> </li><li class="nav-list-item"> <a href="/pages/Overview/alarmScannerAppPreview.html" class="nav-list-link">Alarm Scanner App</a> </li><li class="nav-list-item"> <a href="/pages/Overview/settingsLogAppPreview.html" class="nav-list-link">Settings Log App</a> </li><li class="nav-list-item"> <a href="/pages/Overview/accessLogAppPreview.html" class="nav-list-link">Access Log App</a> </li><li class="nav-list-item"> <a href="/pages/Overview/styleSheets.html" class="nav-list-link">App Style Sheets</a> </li><li class="nav-list-item"> <a href="/pages/Overview/appAuthentication.html" class="nav-list-link">App Authentication</a> </li><li class="nav-list-item"> <a href="/pages/Overview/roleBasedAccess.html" class="nav-list-link">Role Based Access</a> </li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Installation category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/pages/Installation/installOverview.html" class="nav-list-link">Installation</a><ul class="nav-list"><li class="nav-list-item"><a href="/pages/Installation/appServerInstall.html" class="nav-list-link">Application Server</a></li><li class="nav-list-item"><a href="/pages/Installation/blinky-bus-tray.html" class="nav-list-link">Blinky Bus Tray</a></li><li class="nav-list-item"><a href="/pages/Installation/blinky-bus-cube.html" class="nav-list-link">Blinky Bus Cube</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Blinky-Lite" aria-label="Search Blinky-Lite" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/Blinky-Lite" class="site-button" > Blinky-Lite on GitHub </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/pages/Installation/installOverview.html">Installation</a></li> <li class="breadcrumb-nav-list-item"><span>Blinky Bus Cube</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="blinky-bus-cube"> <a href="#blinky-bus-cube" class="anchor-heading" aria-labelledby="blinky-bus-cube"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Blinky Bus Cube </h1> <h2 id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ul> <li>Overview</li> <li><a href="#building-the-circuit">Building the circuit</a></li> <li><a href="#setting-up-the-bluetooth">Setting up the Bluetooth</a></li> <li><a href="#code-discussion">Code Discussion</a></li> </ul> <h2 id="overview"> <a href="#overview" class="anchor-heading" aria-labelledby="overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview </h2> <p>Blinky-Bus is a demonstration project on how to use Blinky-Lite with serial Bluetooth to communicate between the cube and tray. The function of the device is to turn on and off three LEDs.</p> <p>You can obtain the source code for the cube by either cloning the repository or downloading a zip file from the green Code button on the <a href="https://github.com/Blinky-Lite-Exchange/blinky-bus-cube">Github page</a>. <img src="/assets/images/blinky-cube-img/blinkyBusCube.jpg" /><br /></p> <h2 id="building-the-circuit"> <a href="#building-the-circuit" class="anchor-heading" aria-labelledby="building-the-circuit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Building the circuit </h2> <p>The project can be easily built on a breadboard, The components required are:</p> <ul> <li>One <a href="https://www.pjrc.com/store/teensylc.html">Teensy-LC</a> micro-controller</li> <li>Three LEDs</li> <li>Three 220 Ohm resistors</li> <li>One <a href="https://www.electrokit.com/en/product/bluetooth-module-hc-06-serial/">Bluetooth module HC-06</a></li> <li>One <a href="https://www.electrokit.com/en/product/solderless-breadboard-400-tie-points/">Solderless Breadboard with 400 tie-points</a></li> </ul> <p>Wire the circuit up as shown:<br /> <img src="/assets/images/blinky-cube-img/blinkyBusCubeFritzing.png" /><br /></p> <h2 id="setting-up-the-bluetooth"> <a href="#setting-up-the-bluetooth" class="anchor-heading" aria-labelledby="setting-up-the-bluetooth"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting up the Bluetooth </h2> <p>We will use the <a href="https://www.arduino.cc/en/software">Arduino Programming environment</a> to program the Teensy-LC. In addition to the Arduino programming environment, you will need to install <a href="https://www.pjrc.com/teensy/teensyduino.html">Teensyduino</a>.</p> <p>The next step is to set the baud rate, pin code, and name of the HC06 Bluetooth module.</p> <p>This step can be skipped if you are going to use 9600 baud without a pin code. However, <ins>if you do not name the device it will be difficult to find the device during the pairing process</ins>.</p> <p>The baud rate, pin code, and name of the HC06 are setup in the sketch contained in the folder HC06-Setup.The HC06 Bluetooth module is connected to the Serial1 port. The default baud rate of the HC06 is 9600. The baud rate on line 24 of the sketch must match this baud rate. For most Blinky-Lite applications, a baud rate of 19200 is sufficient and this is set on line 5 of the sketch. The user can choose any pin or name as long it is only 4 characters long.</p> <p>Open the Arduino programming environment serial monitor before loading the sketch. Choose the correct board and port under the Tools menu and load the HC06-Setup sketch. If successful, the output of the serial monitor will look like:<br /> <img src="/assets/images/blinky-cube-img/HC06SetupSerialMonitor.png" /><br /></p> <p>Once the HC06-Setup sketch is loaded onto the Teensy-LC, the HC06 Bluetooth module will only communicate at the baud rate defined on line 5 of the HC06-Setup sketch. Any further communication using the HC06-Setup sketch will require to set the baud rate appropriately on line 24.</p> <h2 id="code-discussion"> <a href="#code-discussion" class="anchor-heading" aria-labelledby="code-discussion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Code Discussion </h2> <p>The operating code is contained in the cubeCode.ino sketch<br /> <img width="100%" src="/assets/images/blinky-cube-img/cubeCode.png" /><br /></p> <p>The baud rate is set on line 2 and must match the baud rate set in the HC06-Setup sketch. The commLEDPin sets the LED that will blink during communication exchanges between the cube and the tray.</p> <p>Next in lines 5-16 is a definition of shared memory between a int16_t buffer and the LED states. The first variable must be <strong><em>state</em></strong>.</p> <ul> <li>A value of state=1 will signal the tray that the cube has just been initialized.</li> <li>A value of state=0 means that the tray has been communicating with the cube.</li> <li>The following variables are defined by the user to describe the behavior of the cube.</li> </ul> <p>The cube communicates with the tray during the blinkyBus.poll() routine. During the blinkyBus.poll() routine, the cube checks if the tray has sent any data.</p> <ul> <li>If the tray has not sent any data, the blinkyBus.poll() routine exits with a return value of zero.</li> <li>If the tray sends data, it must send 4 bytes of data. <ul> <li>The first byte is the write command.</li> <li>If the write command is 0, <ul> <li>then the tray has no data to give the cube</li> <li>and the cube sends the entire buffer to the tray</li> <li>and returns a value of 1</li> </ul> </li> <li>If the write command is 1, <ul> <li>Then the next byte is the index of the buffer array to be written</li> <li>and the remaining two bytes are the value to be written.</li> <li>The buffer is written with these two bytes at the buffer index specified.</li> <li>The cube sends the entire buffer to the tray</li> <li>and returns a value of 2</li> </ul> </li> </ul> </li> </ul> <p>After the blinkyBus.poll(), it is possible to determine the last address and value written with the public routines:</p> <ul> <li>BlinkyBus::getLastWriteAddress()</li> <li>BlinkyBus::getLastWriteValue()</li> </ul> <p>Once blinkyBus.poll() routine has been completed, the LEDs are set by current state of the buffer.</p> </main> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Distributed by an <a href="https://raw.githubusercontent.com/Blinky-Lite/blinky-lite-box/master/LICENSE">MIT license.</a></p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
